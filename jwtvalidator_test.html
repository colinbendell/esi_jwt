<esi:comment text="
---- WARNING: GENERATED ESI ----
"/><esi:function name="assertEqual"><esi:assign name="name" value="$(ARGS{0})"/><esi:assign name="val" value="$(ARGS{1})"/><esi:assign name="expect" value="$(ARGS{2})"/><esi:assign name="message" value="'Fail! (expected: '+$(expect)+' but got: '+$(val)+') '"/><esi:choose><esi:when test="$(val)==$(expect)"><esi:assign name="message" value="'Pass'"/></esi:when></esi:choose><esi:return value="'Test '+$(name)+'... '+$(message)+'
'"/></esi:function><esi:function name="logical_right_shift"><esi:assign name="x" value="$(ARGS{0})"/><esi:assign name="n" value="$(ARGS{1})"/><esi:assign name="size" value="32"/><esi:return value="($(x)>>$(n))&(~(((1<<$(size))>>$(n))<<1))"/></esi:function><esi:function name="power"><esi:assign name="n" value="$(ARGS{0})"/><esi:assign name="exp" value="$(ARGS{1})"/><esi:assign name="val" value="1"/><esi:choose><esi:when test="$(exp)>1"><esi:assign name="val" value="$(n)*$power($(n),$(exp)-1)"/></esi:when><esi:when test="$(exp)==1"><esi:assign name="val" value="$(n)"/></esi:when></esi:choose><esi:return value="$(val)"/></esi:function><esi:function name="toBase16"><esi:assign name="val" value="$(ARGS{0})"/><esi:assign name="ret" value="$(HEX_CHARS{$(val)%16})"/><esi:assign name="val" value="$(val)/16"/><esi:choose><esi:when test="$(val)>0"><esi:assign name="ret" value="$toBase16($(val))+$str($(ret))"/></esi:when></esi:choose><esi:return value="$str($(ret))"/></esi:function><esi:assign name="HEX_CHARS" value="'0123456789abcdef'"/><esi:function name="toBase10"><esi:assign name="hex" value="$(ARGS{0})"/><esi:choose><esi:when test="$is_empty($(hex))"><esi:return value="0"/></esi:when></esi:choose><esi:assign name="c" value="$index($(HEX_CHARS),$(hex{0}))"/><esi:assign name="c" value="$(c)*$power(16,$len($(hex))-1)"/><esi:choose><esi:when test="$len($(hex))>1"><esi:assign name="c" value="$(c)+$toBase10($substr($(hex),1))"/></esi:when></esi:choose><esi:return value="$(c)"/></esi:function><esi:function name="toHex"><esi:assign name="number" value="$(ARGS{0})"/><esi:assign name="nstr" value="$toBase16($(number))"/><esi:choose><esi:when test="($len($(nstr))%2)==0"><esi:return value="$(nstr)"/></esi:when></esi:choose><esi:return value="'0'+$(nstr)"/></esi:function><esi:assign name="BASE64_CHARS" value="'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='"/><esi:function name="hexToBase64"><esi:assign name="input" value="$(ARGS{0})"/><esi:assign name="b64value" value="''"/><esi:assign name="i" value="0"/><esi:assign name="_loop" value="[0..((($len($(input))+5)/6)-1)]"/><esi:foreach collection="$(_loop)"><esi:choose><esi:when test="!($(i)<=((($len($(input))+5)/6)-1))"><esi:break/></esi:when></esi:choose><esi:assign name="chr1" value="$toBase10($(input{($(i)*6)+0})+$(input{($(i)*6)+1}))"/><esi:assign name="chr2" value="$toBase10($(input{($(i)*6)+2})+$(input{($(i)*6)+3}))"/><esi:assign name="chr3" value="$toBase10($(input{($(i)*6)+4})+$(input{($(i)*6)+5}))"/><esi:assign name="enc1" value="$(chr1)>>2"/><esi:assign name="enc2" value="(($(chr1)&3)<<4)|($(chr2)>>4)"/><esi:assign name="enc3" value="(($(chr2)&15)<<2)|($(chr3)>>6)"/><esi:assign name="enc4" value="$(chr3)&63"/><esi:choose><esi:when test="(($(i)*6)+3)>$len($(input))"><esi:assign name="enc3" value="64"/><esi:assign name="enc4" value="$(enc3)"/></esi:when><esi:when test="(($(i)*6)+5)>$len($(input))"><esi:assign name="enc4" value="64"/></esi:when></esi:choose><esi:assign name="b64value" value="$(b64value)+($(BASE64_CHARS{$(enc1)})+$(BASE64_CHARS{$(enc2)})+$(BASE64_CHARS{$(enc3)})+$(BASE64_CHARS{$(enc4)}))"/><esi:assign name="i" value="$(i)+1"/></esi:foreach><esi:return value="$(b64value)"/></esi:function><esi:function name="base64toHex"><esi:assign name="input" value="$(ARGS{0})"/><esi:assign name="output" value="''"/><esi:choose><esi:when test="($index($(input),'-')>=0)||($index($(input),'_')>=0)"><esi:assign name="input" value="$replace($replace($(input),'-','+'),'_','/')"/></esi:when></esi:choose><esi:assign name="i" value="0"/><esi:assign name="_loop" value="[0..((($len($(input))+3)/4)-1)]"/><esi:foreach collection="$(_loop)"><esi:choose><esi:when test="!($(i)<=((($len($(input))+3)/4)-1))"><esi:break/></esi:when></esi:choose><esi:assign name="enc1" value="$index($(BASE64_CHARS),$(input{($(i)*4)+0}))"/><esi:assign name="enc2" value="$index($(BASE64_CHARS),$(input{($(i)*4)+1}|'='))"/><esi:assign name="enc3" value="$index($(BASE64_CHARS),$(input{($(i)*4)+2}|'='))"/><esi:assign name="enc4" value="$index($(BASE64_CHARS),$(input{($(i)*4)+3}|'='))"/><esi:assign name="chr1" value="($(enc1)<<2)|($(enc2)>>4)"/><esi:assign name="chr2" value="(($(enc2)&15)<<4)|($(enc3)>>2)"/><esi:assign name="chr3" value="(($(enc3)&3)<<6)|$(enc4)"/><esi:assign name="output" value="$(output)+$toHex($(chr1))"/><esi:choose><esi:when test="$(enc3)!=64"><esi:assign name="output" value="$(output)+$toHex($(chr2))"/></esi:when></esi:choose><esi:choose><esi:when test="$(enc4)!=64"><esi:assign name="output" value="$(output)+$toHex($(chr3))"/></esi:when></esi:choose><esi:assign name="i" value="$(i)+1"/></esi:foreach><esi:assign name="x" value="0"/><esi:assign name="x" value="$(x)+1"/><esi:return value="$(output)"/></esi:function><esi:function name="base64url_decode"><esi:assign name="input" value="$(ARGS{0})"/><esi:assign name="input" value="$replace($replace($(input),'-','+'),'_','/')"/><esi:choose><esi:when test="($len($(input))%4)==2"><esi:assign name="input" value="$(input)+'=='"/></esi:when></esi:choose><esi:choose><esi:when test="($len($(input))%4)==3"><esi:assign name="input" value="$(input)+'='"/></esi:when></esi:choose><esi:return value="$base64_decode($(input))"/></esi:function><esi:function name="prepadSigned"><esi:assign name="hexStr" value="$(ARGS{0})"/><esi:assign name="msb" value="$index($(HEX_CHARS),$(hexStr{0}))"/><esi:choose><esi:when test="$(msb)>=8"><esi:return value="'00'+$(hexStr)"/></esi:when><esi:otherwise><esi:return value="$(hexStr)"/></esi:otherwise></esi:choose></esi:function><esi:function name="encodeLengthHex"><esi:assign name="n" value="$(ARGS{0})"/><esi:choose><esi:when test="$(n)<=127"><esi:return value="$toHex($(n))"/></esi:when><esi:otherwise><esi:assign name="n_hex" value="$toHex($(n))"/><esi:assign name="length_of_length_byte" value="128+($len($(n_hex))/2)"/><esi:return value="$toHex($(length_of_length_byte))+$(n_hex)"/></esi:otherwise></esi:choose></esi:function><esi:function name="formatPem"><esi:assign name="value" value="$(ARGS{0})"/><esi:assign name="returnValue" value="$substr($(value),0,64)"/><esi:choose><esi:when test="$len($(value))>=64"><esi:assign name="returnValue">$(returnValue)+('
'+$formatPem($substr($(value),64)))</esi:assign></esi:when></esi:choose><esi:return value="$(returnValue)"/></esi:function><esi:function name="rsaPublicKeyPem"><esi:assign name="modulus_b64" value="$(ARGS{0}|'00')"/><esi:assign name="exponent_b64" value="$(ARGS{1}|'00')"/><esi:assign name="modulus_hex" value="$base64toHex($(modulus_b64))"/><esi:assign name="exponent_hex" value="$base64toHex($(exponent_b64))"/><esi:assign name="modulus_hex" value="$prepadSigned($(modulus_hex))"/><esi:assign name="exponent_hex" value="$prepadSigned($(exponent_hex))"/><esi:assign name="modlen" value="$len($(modulus_hex))/2"/><esi:assign name="explen" value="$len($(exponent_hex))/2"/><esi:assign name="encoded_modlen" value="$encodeLengthHex($(modlen))"/><esi:assign name="encoded_explen" value="$encodeLengthHex($(explen))"/><esi:assign name="encoded_pubkey" value="'30'+$encodeLengthHex($(modlen)+$(explen)+($len($(encoded_modlen))/2)+($len($(encoded_explen))/2)+2)+'02'+$(encoded_modlen)+$(modulus_hex)+'02'+$(encoded_explen)+$(exponent_hex)"/><esi:assign name="seq2" value="'300d'+'06092a864886f70d010101'+'0500'+'03'+$encodeLengthHex(($len($(encoded_pubkey))/2)+1)+'00'+$(encoded_pubkey)"/><esi:assign name="der_hex" value="'30'+$encodeLengthHex($len($(seq2))/2)+$(seq2)"/><esi:return value="'-----BEGIN PUBLIC KEY-----
'+$formatPem($hexToBase64($(der_hex)))+'
-----END PUBLIC KEY-----
'"/></esi:function><esi:function name="findCert"><esi:assign name="certs" value="$(ARGS{0})"/><esi:assign name="kid" value="$(ARGS{1}|'')"/><esi:assign name="key" value="$(certs{0})"/><esi:choose><esi:when test="$(key{'kid'})==$(kid)"><esi:return value="$(key)"/></esi:when></esi:choose><esi:choose><esi:when test="$len($(certs))>1">$list_delitem($(certs),0)<esi:return value="$findCert($(certs),$(kid))"/></esi:when></esi:choose><esi:return value="{}"/></esi:function><esi:function name="parseJWT"><esi:assign name="jwt" value="$(ARGS{0})"/><esi:assign name="parts" value="$string_split($(jwt),'.')"/><esi:assign name="header" value="$base64url_decode($(parts{0}))"/><esi:assign name="payload" value="$base64url_decode($(parts{1}))"/><esi:assign name="message" value="$(parts{0})+'.'+$(parts{1})"/><esi:assign name="signature" value="$(parts{2})"/><esi:choose><esi:when test="($len($(signature))%4)==2"><esi:assign name="signature" value="$(signature)+'=='"/></esi:when></esi:choose><esi:choose><esi:when test="($len($(signature))%4)==3"><esi:assign name="signature" value="$(signature)+'='"/></esi:when></esi:choose><esi:assign name="items">$string_split($(header),'"')</esi:assign><esi:assign name="kid" value="$(items{7}|$(items{5}|''))"/><esi:assign name="jwtObject" value="{'token':$(jwt),'header':$(header),'payload':$(payload),'message':$(message),'kid':$(kid),'signature':$(signature)}"/><esi:return value="$(jwtObject)"/></esi:function><esi:assign name="urlPrefix" value="''"/><esi:assign name="googleConfigUrl" value="'https://accounts.google.com/.well-known/openid-configuration'"/><esi:assign name="altUrl" value="$(urlPrefix)+'/google-openid-configuration.json'"/><esi:assign name="xhrUrl" value="$(urlPrefix)+'/esi/xhr2json.html?name=openidConfig&url='+$url_encode($(googleConfigUrl))+'&alt='+$url_encode($(altUrl))"/><esi:eval src="$(xhrUrl)" onerror="continue"/><esi:assign name="altUrl" value="$(urlPrefix)+'/google-jwks.json'"/><esi:assign name="xhrUrl" value="$(urlPrefix)+'/esi/xhr2json.html?name=jwks&url='+$url_encode($(openidConfig{'jwks_uri'}))+'&alt='+$url_encode($(altUrl))"/><esi:eval src="$(xhrUrl)" onerror="continue"/><esi:function name="getVerifyUrl"><esi:assign name="url" value="$(ARGS{0})"/><esi:assign name="jwt" value="$(ARGS{1})"/><esi:assign name="jwks" value="$(ARGS{2})"/><esi:assign name="setCookie" value="$(ARGS{3}|1)"/><esi:assign name="jwt" value="$parseJWT($(jwt))"/><esi:assign name="key" value="$findCert($(jwks{'keys'}),$(jwt{'kid'}))"/><esi:assign name="modulus" value="$(key{'n'}|'00')"/><esi:assign name="exponent" value="$(key{'e'}|'00')"/><esi:choose><esi:when test="($(modulus)=='00')||($(exponent)=='00')"><esi:return value="$(url)"/></esi:when></esi:choose><esi:assign name="pem" value="$rsaPublicKeyPem($(modulus),$(exponent))"/><esi:assign name="pemUrlSafe">$replace($(pem),'
','\\n')</esi:assign><esi:choose><esi:when test="$(setCookie)">$add_header('Set-Cookie','data='+$(jwt{'message'})+'; Path=/; Secure; Max-Age=30;')$add_header('Set-Cookie','sig='+$(jwt{'signature'})+'; Path=/; Secure; Max-Age=30;')$add_header('Set-Cookie','pem='+$(pemUrlSafe)+'; Path=/; Secure; Max-Age=30;')</esi:when><esi:otherwise><esi:assign name="url" value="$(url)+('?data='+$(jwt{'message'})+'&sig='+$(jwt{'signature'})+'&pem='+$url_encode($(pemUrlSafe)))"/></esi:otherwise></esi:choose><esi:return value="$(url)"/></esi:function><esi:assign name="jwt" value="$(QUERY_STRING{'access_token'}|'')"/><esi:assign name="url" value="$(QUERY_STRING{'url'}|'/data/verify')"/><esi:assign name="verifyUrl" value="$getVerifyUrl($(url),$(jwt),$(jwks))"/><esi:vars>$set_redirect($(verifyUrl))</esi:vars><esi:vars>$add_cachebusting_header()</esi:vars><esi:assign name="jwks_test" value="{'keys':[{'kty':'RSA','alg':'RS256','use':'sig','kid':'70484949aa0a58ac391c3883ee2d3f62e93bf780','n':'412CDT2txyBC1tEs5QEafP1mGgh2Q0c-oVP96WPuw2FiWVbEOsXu_hLoSP3hU75M0b832h6Tq13GijGsHLxIKzZrP1QQ6SRh3PCqY_ox_K-QjfFayqRsAsHkR2nEciOvrnTc5EbxOK1uXu8rbVEV8pFl6h_BZneClTcsehI_WYB--3fHDz9RDtJV97UIq2UdcafzaTFl76DLoWb4hQuNIby1ujXy_5tcJbZHpvSBEzq99AaRuSsYVmnYDNqDTu0qQOGKs55UeHKVpH5TrwX6CG2yitpePBcFbHhf5iOXUULFC8PBakgWGUGQTpKnpvevutRJ3ISoobIG61ANy-H3uQ==','e':'AQAB'},{'kty':'RSA','alg':'RS256','use':'sig','kid':'ca04df587b5a7cead80abee9ea8dcf7586a78e01','n':'iXn-WmrwLLBa-QDiToBozpu4Y4ThKdwORWFXQa9I75pKOvPUjUjE2Bk05TUSt7-V7KDjCq0_Nkd-X9rMRV5LKgCa0_F8YgI30QS3bUm9orFryrdOc65PUIVFVxIwMZuGDY1hj6HEJVWIr0CZdcgNIll06BasclckkUK4O-Eh7MaQrqb646ghFlG3zlgk9b2duHbDOq3s39ICPinRQWC6NqTYfqg7E8GN_NLY9srUCc_MswuUfMJ2cKT6edrhLuIwIj_74YGkpOwilr2VswKsvJ7dcoiJxheKYvKDKtZFkbKrWETTJSGX2Xeh0DFB0lqbKLVvqkM2lFU2Qx1OgtTnrw==','e':'AQAB'}]}"/><esi:assign name="jwt_test" value="'eyJhbGciOiJSUzI1NiIsImtpZCI6ImNhMDRkZjU4N2I1YTdjZWFkODBhYmVlOWVhOGRjZjc1ODZhNzhlMDEifQ.eyJhenAiOiI0NTQ1MzQ2ODUxNi01bXAwZjVpN3I2c2xjazE4ZW9hZTg3Y2s3b2ZxcjNzby5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjQ1NDUzNDY4NTE2LTVtcDBmNWk3cjZzbGNrMThlb2FlODdjazdvZnFyM3NvLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA0NTY0NjEwMDUzNzQ0NTMwMTExIiwiaGQiOiJha2FtYWkuY29tIiwiZW1haWwiOiJjb2xpbmJAYWthbWFpLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiUnQtSmFtcGtzaGd1NDh4TkxuQlpoQSIsImlzcyI6ImFjY291bnRzLmdvb2dsZS5jb20iLCJpYXQiOjE1MDI3Njc1NTAsImV4cCI6MTUwMjc3MTE1MCwibmFtZSI6IkNvbGluIEJlbmRlbGwiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1sZGt2MDM4dTdKYy9BQUFBQUFBQUFBSS9BQUFBQUFBQUFUay9WWDdiUDdKeWo2MC9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiQ29saW4iLCJmYW1pbHlfbmFtZSI6IkJlbmRlbGwiLCJsb2NhbGUiOiJlbi1DQSJ9.IXp3wfMdzy9JLfDr51vkbPstlfcqVZK1tu8Su6XaDzz9aQbEdOG0tktECdKlAoyw1E2RrFYqzHbuk2CcJ-cUy5Mcerar-h5cbBglMxZkk9DOrd0iDjqW0mhCBkXiM9VavGjunhrzunPFRoVaLG6_j965UVnXY3gVnZIcMdFOLCyknmjpDJBlw1GGFEw3IyiyFuJFm1bDPZk0mMVNF0a2nKx_4386VX_SqZwHM_WszmIdlcnTIDS7LxTzm2IdHZ65ufFacvq4KPRtNxz_mterYRzUBSpWviiHm1ZAyUelIny6cwP_k4NR3--5UP2cSbFbSIG2hS1cw7gPWJXjGzi0-Q'"/><esi:assign name="parsed_jwt">{'header':'{"alg":"RS256","kid":"ca04df587b5a7cead80abee9ea8dcf7586a78e01"}','payload':'{"azp":"45453468516-5mp0f5i7r6slck18eoae87ck7ofqr3so.apps.googleusercontent.com","aud":"45453468516-5mp0f5i7r6slck18eoae87ck7ofqr3so.apps.googleusercontent.com","sub":"104564610053744530111","hd":"akamai.com","email":"colinb@akamai.com","email_verified":true,"at_hash":"Rt-Jampkshgu48xNLnBZhA","iss":"accounts.google.com","iat":1502767550,"exp":1502771150,"name":"Colin Bendell","picture":"https://lh4.googleusercontent.com/-ldkv038u7Jc/AAAAAAAAAAI/AAAAAAAAATk/VX7bP7Jyj60/s96-c/photo.jpg","given_name":"Colin","family_name":"Bendell","locale":"en-CA"}','token':'eyJhbGciOiJSUzI1NiIsImtpZCI6ImNhMDRkZjU4N2I1YTdjZWFkODBhYmVlOWVhOGRjZjc1ODZhNzhlMDEifQ.eyJhenAiOiI0NTQ1MzQ2ODUxNi01bXAwZjVpN3I2c2xjazE4ZW9hZTg3Y2s3b2ZxcjNzby5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjQ1NDUzNDY4NTE2LTVtcDBmNWk3cjZzbGNrMThlb2FlODdjazdvZnFyM3NvLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA0NTY0NjEwMDUzNzQ0NTMwMTExIiwiaGQiOiJha2FtYWkuY29tIiwiZW1haWwiOiJjb2xpbmJAYWthbWFpLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiUnQtSmFtcGtzaGd1NDh4TkxuQlpoQSIsImlzcyI6ImFjY291bnRzLmdvb2dsZS5jb20iLCJpYXQiOjE1MDI3Njc1NTAsImV4cCI6MTUwMjc3MTE1MCwibmFtZSI6IkNvbGluIEJlbmRlbGwiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1sZGt2MDM4dTdKYy9BQUFBQUFBQUFBSS9BQUFBQUFBQUFUay9WWDdiUDdKeWo2MC9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiQ29saW4iLCJmYW1pbHlfbmFtZSI6IkJlbmRlbGwiLCJsb2NhbGUiOiJlbi1DQSJ9.IXp3wfMdzy9JLfDr51vkbPstlfcqVZK1tu8Su6XaDzz9aQbEdOG0tktECdKlAoyw1E2RrFYqzHbuk2CcJ-cUy5Mcerar-h5cbBglMxZkk9DOrd0iDjqW0mhCBkXiM9VavGjunhrzunPFRoVaLG6_j965UVnXY3gVnZIcMdFOLCyknmjpDJBlw1GGFEw3IyiyFuJFm1bDPZk0mMVNF0a2nKx_4386VX_SqZwHM_WszmIdlcnTIDS7LxTzm2IdHZ65ufFacvq4KPRtNxz_mterYRzUBSpWviiHm1ZAyUelIny6cwP_k4NR3--5UP2cSbFbSIG2hS1cw7gPWJXjGzi0-Q','message':'eyJhbGciOiJSUzI1NiIsImtpZCI6ImNhMDRkZjU4N2I1YTdjZWFkODBhYmVlOWVhOGRjZjc1ODZhNzhlMDEifQ.eyJhenAiOiI0NTQ1MzQ2ODUxNi01bXAwZjVpN3I2c2xjazE4ZW9hZTg3Y2s3b2ZxcjNzby5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjQ1NDUzNDY4NTE2LTVtcDBmNWk3cjZzbGNrMThlb2FlODdjazdvZnFyM3NvLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA0NTY0NjEwMDUzNzQ0NTMwMTExIiwiaGQiOiJha2FtYWkuY29tIiwiZW1haWwiOiJjb2xpbmJAYWthbWFpLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiUnQtSmFtcGtzaGd1NDh4TkxuQlpoQSIsImlzcyI6ImFjY291bnRzLmdvb2dsZS5jb20iLCJpYXQiOjE1MDI3Njc1NTAsImV4cCI6MTUwMjc3MTE1MCwibmFtZSI6IkNvbGluIEJlbmRlbGwiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1sZGt2MDM4dTdKYy9BQUFBQUFBQUFBSS9BQUFBQUFBQUFUay9WWDdiUDdKeWo2MC9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiQ29saW4iLCJmYW1pbHlfbmFtZSI6IkJlbmRlbGwiLCJsb2NhbGUiOiJlbi1DQSJ9','signature':'IXp3wfMdzy9JLfDr51vkbPstlfcqVZK1tu8Su6XaDzz9aQbEdOG0tktECdKlAoyw1E2RrFYqzHbuk2CcJ-cUy5Mcerar-h5cbBglMxZkk9DOrd0iDjqW0mhCBkXiM9VavGjunhrzunPFRoVaLG6_j965UVnXY3gVnZIcMdFOLCyknmjpDJBlw1GGFEw3IyiyFuJFm1bDPZk0mMVNF0a2nKx_4386VX_SqZwHM_WszmIdlcnTIDS7LxTzm2IdHZ65ufFacvq4KPRtNxz_mterYRzUBSpWviiHm1ZAyUelIny6cwP_k4NR3--5UP2cSbFbSIG2hS1cw7gPWJXjGzi0-Q==','kid':'ca04df587b5a7cead80abee9ea8dcf7586a78e01'}</esi:assign><esi:vars>$assertEqual('parseJWT("eyJhbGciOi...Gzi0-Q")',$parseJWT($(jwt_test)),$str($(parsed_jwt)))</esi:vars><esi:assign name="verifyUrl" value="'/verify?data=eyJhbGciOiJSUzI1NiIsImtpZCI6ImNhMDRkZjU4N2I1YTdjZWFkODBhYmVlOWVhOGRjZjc1ODZhNzhlMDEifQ.eyJhenAiOiI0NTQ1MzQ2ODUxNi01bXAwZjVpN3I2c2xjazE4ZW9hZTg3Y2s3b2ZxcjNzby5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjQ1NDUzNDY4NTE2LTVtcDBmNWk3cjZzbGNrMThlb2FlODdjazdvZnFyM3NvLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA0NTY0NjEwMDUzNzQ0NTMwMTExIiwiaGQiOiJha2FtYWkuY29tIiwiZW1haWwiOiJjb2xpbmJAYWthbWFpLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiUnQtSmFtcGtzaGd1NDh4TkxuQlpoQSIsImlzcyI6ImFjY291bnRzLmdvb2dsZS5jb20iLCJpYXQiOjE1MDI3Njc1NTAsImV4cCI6MTUwMjc3MTE1MCwibmFtZSI6IkNvbGluIEJlbmRlbGwiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1sZGt2MDM4dTdKYy9BQUFBQUFBQUFBSS9BQUFBQUFBQUFUay9WWDdiUDdKeWo2MC9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiQ29saW4iLCJmYW1pbHlfbmFtZSI6IkJlbmRlbGwiLCJsb2NhbGUiOiJlbi1DQSJ9&sig=IXp3wfMdzy9JLfDr51vkbPstlfcqVZK1tu8Su6XaDzz9aQbEdOG0tktECdKlAoyw1E2RrFYqzHbuk2CcJ-cUy5Mcerar-h5cbBglMxZkk9DOrd0iDjqW0mhCBkXiM9VavGjunhrzunPFRoVaLG6_j965UVnXY3gVnZIcMdFOLCyknmjpDJBlw1GGFEw3IyiyFuJFm1bDPZk0mMVNF0a2nKx_4386VX_SqZwHM_WszmIdlcnTIDS7LxTzm2IdHZ65ufFacvq4KPRtNxz_mterYRzUBSpWviiHm1ZAyUelIny6cwP_k4NR3--5UP2cSbFbSIG2hS1cw7gPWJXjGzi0-Q==&pem=-----BEGIN%20PUBLIC%20KEY-----%5cnMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAiXn%2bWmrwLLBa%2bQDiToBo%5cnzpu4Y4ThKdwORWFXQa9I75pKOvPUjUjE2Bk05TUSt7%2bV7KDjCq0%2fNkd%2bX9rMRV5L%5cnKgCa0%2fF8YgI30QS3bUm9orFryrdOc65PUIVFVxIwMZuGDY1hj6HEJVWIr0CZdcgN%5cnIll06BasclckkUK4O%2bEh7MaQrqb646ghFlG3zlgk9b2duHbDOq3s39ICPinRQWC6%5cnNqTYfqg7E8GN%2fNLY9srUCc%2fMswuUfMJ2cKT6edrhLuIwIj%2f74YGkpOwilr2VswKs%5cnvJ7dcoiJxheKYvKDKtZFkbKrWETTJSGX2Xeh0DFB0lqbKLVvqkM2lFU2Qx1OgtTn%5cnrwIDAQAB%5cn-----END%20PUBLIC%20KEY-----%5cn'"/><esi:vars>$assertEqual('getVerifyUrl("eyJhbGciOi...Gzi0-Q")',$getVerifyUrl('/verify',$(jwt_test),$(jwks_test),0),$(verifyUrl))</esi:vars><esi:assign name="verifyUrl" value="$(urlPrefix)+'/verify'"/><esi:vars>$assertEqual('getVerifyUrl("")',$getVerifyUrl('/verify','','',0),$(verifyUrl))</esi:vars><esi:assign name="verifyUrl" value="$(urlPrefix)+'/verify'"/><esi:vars>$assertEqual('getVerifyUrl()',$getVerifyUrl('/verify',$(null),$(null),0),$(verifyUrl))</esi:vars><esi:vars>$set_response_code(200)</esi:vars>